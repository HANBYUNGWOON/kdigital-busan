-- 다음과 같은 속성을 가진 NewBook 테이블을 생성하시오,
-- 정수형은 NUMBER를, 문자형은 가변형 문자타입인 VARCHAR2를 사용
-- bookid(도서번호) ? NUMBER
-- bookname(도서이름) ? VARCHAR2(20)
-- publisher(출판사) ? VARCHAR2(20)
-- price(가격) ? NUMBER

CREATE TABLE NEWBOOK_OCH
(
    BOOKID NUMBER
    , BOOKNAME VARCHAR2 (20)
    , PUBLISHER VARCHAR2 (20)
    , PRICE NUMBER
);

DROP TABLE NEWBOOK_OCH;

-- 주식별자 지정
CREATE TABLE NEWBOOK_OCH
(
    BOOKID NUMBER -- PRIMARY KEY
    , BOOKNAME VARCHAR2 (20)
    , PUBLISHER VARCHAR2 (20)
    , PRICE NUMBER
    -- , PRIMARY KEY (BOOKID)
    -- , CONSTRAINT PK_NEWBOOK_OCH PRIMARY KEY (BOOKID)
    , PRIMARY KEY (BOOKID, BOOKNAME)
);
DESC NEWBOOK_OCH;
DROP TABLE NEWBOOK_OCH;

-- 기타 제약 조건 : 기본값 지정, CHECK 제약 조건
CREATE TABLE NEWBOOK_OCH
(
    BOOKID NUMBER
    , BOOKNAME VARCHAR2 (20)
    , PUBLISHER VARCHAR2 (20)
    , PRICE NUMBER DEFAULT (0) CHECK(PRICE >= 0)
    , PRIMARY KEY (BOOKID)
);
DESC NEWBOOK_OCH;
DROP TABLE NEWBOOK_OCH;

-- 다음과 같은 속성을 가진 NewCustomer 테이블을 생성하시오
--custid(고객번호) - NUMBER, 기본키
--name(이름) ? VARCHAR2(40)
--address(주소) ? VARCHAR2(40)
--phone(전화번호) ? VARCHAR2(30)
CREATE TABLE NEWCUSTOMER_OCH
(
    CUSTID NUMBER
    , NAME VARCHAR2 (40)
    , ADDRESS VARCHAR2 (40)
    , PHONE VARCHAR2 (30)
    , PRIMARY KEY (CUSTID)
);
DESC NEWCUSTOMER_OCH;

--다음과 같은 속성을 가진 NewOrders 테이블을 생성하시오.
--orderid(주문번호) - NUMBER, 기본키
--custid(고객번호) - NUMBER, NOT NULL 제약조건, 외래키(NewCustomer.custid, 연쇄삭제)
--bookid(도서번호) - NUMBER, NOT NULL 제약조건
--saleprice(판매가격) - NUMBER
--orderdate(판매일자) - DATE

CREATE TABLE NEWORDERS_OCH
(
    ORDERID NUMBER
    , CUSTID NUMBER NOT NULL
    , BOOKID NUMBER NOT NULL
    , SALEPRICE NUMBER NULL
    , ORDERDATE DATE NULL
    , PRIMARY KEY (ORDERID)
    , FOREIGN KEY (CUSTID) REFERENCES NEWCUSTOMER_OCH(CUSTID) ON DELETE CASCADE
    , CONSTRAINT FK_NEWBOOK_OCH_NEWORDERS_OCH FOREIGN KEY (BOOKID) REFERENCES NEWBOOK_OCH(BOOKID)
);
DESC NEWORDERS_OCH;
DROP TABLE NEWORDERS_OCH;

------------------------------------------

DROP TABLE NEWORDERS_OCH;
DROP TABLE NEWBOOK_OCH;

CREATE TABLE NEWBOOK_OCH
(
    BOOKID NUMBER
    , BOOKNAME VARCHAR2 (20)
    , PUBLISHER VARCHAR2 (20)
    , PRICE NUMBER
);
DESC NEWBOOK_OCH;

-- NewBook 테이블에 VARCHAR2(13)의 자료형을 가진 isbn 속성을 추가하시오
ALTER TABLE NEWBOOK_OCH
ADD ISBN VARCHAR2(13);

DESC NEWBOOK_OCH;

-- NewBook 테이블의 isbn 속성의 데이터 타입을 NUMBER형으로 변경하시오
ALTER TABLE NEWBOOK_OCH
MODIFY ISBN NUMBER;
DESC NEWBOOK_OCH;

-- NewBook 테이블의 isbn 속성을 삭제하시오
ALTER TABLE NEWBOOK_OCH
DROP COLUMN ISBN;
DESC NEWBOOK_OCH;

--  NewBook 테이블의 bookid 속성에 NOT NULL 제약조건을 적용하시오
ALTER TABLE NEWBOOK_OCH
MODIFY BOOKID NUMBER NOT NULL;
DESC NEWBOOK_OCH;

